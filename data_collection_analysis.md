# 辦公室電錶數據收集與用電預測分析

## 數據收集需求分析

### 電錶數據特性
- **收集頻率**：每5秒收集一次，相當於每分鐘12筆數據，每小時720筆，每天17,280筆
- **數據粒度**：高頻時間序列數據，適合捕捉短期用電波動和模式
- **時間跨度**：需要考慮至少幾週到幾個月的數據，以捕捉週期性模式（日內、週內、月內）

### 建議收集的數據欄位
1. **時間戳記**：精確到秒的數據收集時間
2. **有功功率**：實際消耗的電力（kW或W）
3. **無功功率**：（如果可用）
4. **電壓**：供電電壓值
5. **電流**：電流值
6. **功率因數**：（如果可用）
7. **累計用電量**：電錶讀數（kWh）
8. **相位資訊**：（如果是三相電）

### 數據儲存需求
- **每日數據量**：假設每筆記錄約100字節，則每日約1.7MB
- **每月數據量**：約51MB
- **每年數據量**：約620MB
- **建議儲存格式**：
  - 原始數據：CSV或時間序列資料庫（如InfluxDB、TimescaleDB）
  - 處理後數據：結構化格式（如Parquet）以提高查詢效率

### 預測目標時間範圍
根據辦公室用電特性，可分為以下預測範圍：
1. **短期預測**（分鐘到小時）：
   - 適用於即時負載管理
   - 可預測未來15分鐘、30分鐘、1小時的用電量
   - 有助於避免尖峰用電超出契約容量

2. **中期預測**（天到週）：
   - 適用於日常能源管理和排程
   - 可預測未來1天、3天、1週的用電模式
   - 有助於優化空調、照明等系統運行時間

3. **長期預測**（月到季）：
   - 適用於能源規劃和預算
   - 可預測未來1個月、3個月的用電趨勢
   - 有助於評估節能措施效果和長期用電趨勢

### 辦公室用電模式特點
1. **工作時間模式**：
   - 工作日（週一至週五）與週末用電模式差異明顯
   - 上班時間（如9:00-18:00）用電量高，非工作時間低
   - 午休時間可能出現短暫用電下降

2. **季節性模式**：
   - 夏季空調用電增加
   - 冬季暖氣/電暖器用電增加（視地區而定）
   - 日照時間變化影響照明用電

3. **特殊事件影響**：
   - 假日、公司活動可能導致異常用電模式
   - 設備維護、新設備安裝可能改變用電基準

4. **設備使用模式**：
   - 辦公設備（電腦、印表機等）在工作時間使用頻繁
   - 空調系統可能有預設的啟動/關閉時間
   - 伺服器、網路設備等可能24小時運行

## 數據收集挑戰與解決方案

### 挑戰
1. **數據量大**：高頻收集導致大量數據
2. **數據質量**：可能存在缺失值、異常值
3. **數據存儲**：需要高效存儲和查詢機制
4. **數據整合**：可能需要整合其他數據源（如天氣、辦公室使用情況）

### 解決方案
1. **數據降採樣**：
   - 對於長期預測，可將5秒數據聚合為分鐘、小時級別
   - 保留原始高頻數據用於短期預測和異常檢測

2. **數據清洗策略**：
   - 設計自動化數據驗證和清洗流程
   - 建立異常值檢測機制

3. **分層存儲策略**：
   - 熱數據（近期）保持高精度
   - 冷數據（歷史）可降採樣後存儲

4. **數據備份**：
   - 建立定期備份機制，確保數據安全

## 預測系統架構建議

### 數據收集層
- 電錶數據採集系統
- 數據傳輸協議（如MQTT、HTTP）
- 初步數據驗證

### 數據處理層
- 數據清洗和預處理
- 特徵工程
- 數據聚合和降採樣

### 分析和預測層
- 時間序列預測模型
- 模型訓練和評估
- 預測結果生成

### 應用層
- 預測結果可視化
- 異常檢測和警報
- 用電優化建議

### 存儲層
- 時間序列數據庫
- 模型參數存儲
- 預測結果存儲
